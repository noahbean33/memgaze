# -*-Mode: makefile;-*-
#****************************************************************************

CC  = g++
CXX = g++ -std=gnu++11  #-std=c++11

#****************************************************************************

# Auto-discover root directory and (may need make 3.81+)
mkfile_me := $(word $(words $(MAKEFILE_LIST)),$(MAKEFILE_LIST))

MIAMI_HOME := $(abspath $(dir $(mkfile_me)))

PALM_ROOT ?= $(MIAMI_HOME)/../../palm/trunk

#****************************************************************************

PALM_EXT = $(PALM_ROOT)/../../palm-externals/trunk

HPCTOOLKIT_EXT = $(PALM_EXT)/hpctoolkit-externals/x86_64-linux

DYNINST_ROOT = $(HPCTOOLKIT_EXT)/symtabAPI
DYNINST_INC = $(DYNINST_ROOT)/include
DYNINST_LIB = $(DYNINST_ROOT)/lib

XED_ROOT = $(HPCTOOLKIT_EXT)/xed2
XED_INC = $(XED_ROOT)/include
XED_LIB = $(XED_ROOT)/lib

BOOST_ROOT = $(HPCTOOLKIT_EXT)/boost
BOOST_INC = $(BOOST_ROOT)/include
BOOST_LIB = $(BOOST_ROOT)/lib

BINUTILS_ROOT = $(HPCTOOLKIT_EXT)/binutils

#****************************************************************************

LINKER := $(CXX)

TOOL_LPATHS += -L$(XED_LIB)
TOOL_LIBS += -ldl

SATOOL_LIBS += -Wl,-Bstatic -Wl,-Bdynamic -ldl

COMP_OBJ += -c -o
LINK_EXE += -o

#****************************************************************************

# set variable COMPILE_MIAMI_SO to "yes" to compile a shared library version 
# of the miami post-processing tool in addition to the standanlone version. 
# This library is not used anymore, but is left in for historical reasons.
# miami.so requires PIC versions of all linked libraries, e.g. binutils
# COMPILE_MIAMI_SO = yes

MIAMI_TARGET = $(MIAMI_HOME)/install
